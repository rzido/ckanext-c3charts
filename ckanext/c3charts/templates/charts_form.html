{% resource 'c3charts/form' %}
{% import 'macros/form.html' as form %}

<div data-module="c3charts_form"
     data-module-controls="{{ h.dump_json(resource_view) }}"
     id="c3controls"
     class="c3controls">
     
     
     <div class="wizard" id="chart_configurer">
  <ul class="nav nav-tabs" id="myTab">
    <li class="active"><a href="#wizard_download">Download <i class="icon-ok" style="display: none;"></i></a></li>
    <li><a href="#wizard_data_configuration">Konfiguration Daten <i class="icon-ok" style="display: none;"></i></a></li>
    <li><a href="#wizard_chart_configuration">Konfiguration Diagramm <i class="icon-ok" style="display: none;"></i></a></li>
  </ul>
  <div class="wizard-panes">
    <div id="wizard_download" class="wizard-pane active">
      <h2><span class="wizard-pane-index"></span> Download</h2>
      <p>Laden sie die Ressource herunter.</p>
      <div id="raw_data_container" class="control-group control-full">
        <textarea id="field-chart_data" name="chart_data" rows="10"></textarea>
        <div class="overlay">
          <div>Loading...</div>
        </div>
      </div>
      <button id="download_data" class="btn" type="button" onclick="this.blur();loadCSV();">Download Starten</button>
      <button class="btn wizard-pane-next" type="button" onclick="wizardTabs.nextPane(this);" disabled>Weiter</button>

    </div>
    <div id="wizard_data_configuration" class="wizard-pane">
      <h2><span class="wizard-pane-index"></span> Konfiguration Daten</h2>
      <p>Konfigurieren sie den Import der Daten zur Weiterverarbeitung.</p>
      <div id="parsed_data_container">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
      <div id="data_config" class="config-form">
        <div class="control-group group__delimiter">
          <label class="control-label">CSV Delimiter</label>
          <div class="controls">
            <input class="span1 update" type="text" id="delimiter"/> 
          </div>
        </div>
        <div class="control-group group__number-formatting">
          <label class="control-label" for="german-numbers">Deutsche Zahlen-formatierung</label>
          <div class="controls">
            <label class="checkbox">
              <input type="checkbox" id="german-numbers" class="update"> 
              ("3<span class="mark__character">.</span>100<span class="mark__character">,</span>32")
            </label>
          </div>
        </div>
      </div>
      <button id="parse_data" class="btn" type="button" onclick="this.blur();parseData();">CSV Daten Parsen</button>
      <button class="btn wizard-pane-next" type="button" onclick="wizardTabs.nextPane(this);">Weiter</button>
    </div>
    <div id="wizard_chart_configuration" class="wizard-pane">
      <h2><span class="wizard-pane-index"></span> Konfiguration Diagramm</h2>
      <p>Konfigurieren sie das Diagramm.</p>
      <div id="chart_config" class="config-form">
        <div class="control-group group__x-axis">
          <label>X-Achse</label>
          <select id="x-axis-select" class="update">
          </select>
        </div>
        <div class="control-group group__chart_type">
          <label>Diagramm Typ</label>
          <select id="chart-type" class="update">
            <option value='line'>Liniendiagramm</option>
            <option value='bar'>Balkendiagramm</option>
          </select>
        </div>
        <div class="control-group">
          <label>Zeilenauswahl</label>
          <input class="span3" type="text" id="row_selection"/> 
        </div>
        <div class="control-group">
          <label>Bezeichner X-Achse</label>
          <input class="span3" type="text" id="x-axis-label"/> 
        </div>
        <div class="control-group">
          <label>Bezeichner Y-Achse</label>
          <input class="span3" type="text" id="y-axis-label"/> 
        </div>
      </div>
    </div>
  </div>
</div>

    {% block form %}

        {{ form.select('chart_type', label=_('Chart Type'), options=chart_types,
            selected=resource_view['chart_type'], is_required=True) }}

        {{ form.select('color_scheme', label=_('Color Pattern'), options=color_schemes,
            selected=resource_view['color_scheme'], is_required=True) }}

        {{ form.select('legend', label=_('Legend'), options=legend_options,
            selected=resource_view['legend'], is_required=True) }}

        {{ form.checkbox('rotated', id='rotated', value='True', label=_('Rotate axis'),
                            checked=resource_view['rotated'] is defined) }}

        {{ form.checkbox('data_labels', id='data_labels', value='True', label=_('Show data labels'),
                            checked=resource_view['data_labels'] is defined) }}

        {{ form.checkbox('x_grid', id='x_grid', value='True', label=_('Show grid on x axis'),
                            checked=resource_view['x_grid'] is defined) }}

        {{ form.checkbox('y_grid', id='y_grid', value='True', label=_('Show grid on y axis'),
                            checked=resource_view['y_grid'] is defined) }}

        {{ form.checkbox('aggregate', id='aggregate', value='True', label=_('Aggregate progress keys'),
                            checked=resource_view['aggregate'] is defined) }}
          
        {{ form.checkbox('zoom', id='zoom', value='True', label=_('Zoom enabled'),
                            checked=resource_view['zoom'] is defined) }}

        {{ form.checkbox('subchart', id='subchart', value='True', label=_('Show subchart'),
                            checked=resource_view['subchart'] is defined) }}

     
        <div class="alert alert-info">
            <p>Select the keys for the data that needs to be charted.</p>
        </div>
        <label class="control-label" id="key_fields_label">
            <span title="This field is required" class="control-required">*</span> Data keys
        </label>
        <div class="c3charts-form-split-container" id="key_fields_container">
            {% for item in fields %}
                {{ form.checkbox('key_fields', id=['key_fields_', item.value]|join, label=item.value,
                            value=item.value, checked=False, classes=['c3select']) }}
            {% endfor %}
        </div>
        <div id="remap-key">
            {{ form.select('remap_key', label=_('Remap'), options=remap_keys,
            selected=resource_view['remap_key'], is_required=False) }}
        </div>
        {{ form.input('measure_unit_y', label=_('Append Unit'), value=resource_view['measure_unit_y']) }}

        <div id="x-fields">
            <div class="alert alert-info" id="x_fields_help">
                <p>Select the keys for the progression (x-axis) of the data values.</p>
            </div>
            <label class="control-label" id="x_fields_label">
                <span title="This field is required" class="control-required">*</span> Progress keys
            </label>
            <div class="c3charts-form-split-container" id="x_fields_container">
                {% for item in fields %}
                    {{ form.checkbox('x_fields', id=['x_fields_', item.value]|join, label=item.value,
                            value=item.value, checked=False, classes=['c3select']) }}
                {% endfor %}
            </div>
            {{ form.input('measure_unit_x', label=_('Append Unit'), value=resource_view['measure_unit_x']) }}
        </div>
        <div id="table-chart">
            <div class="alert alert-info">
                <p>Customize the look of the table chart.</p>
            </div>
            {{ form.textarea('header', id='header', value=resource_view['header'], label='Header text') }}
            {{ form.select('text_chart_number_action', label=_('Number value'), options=text_chart_number_actions,
                selected=resource_view['text_chart_number_action'], is_required=True) }}
        </div>

    {% endblock %}

</div>
